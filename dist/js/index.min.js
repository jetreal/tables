var scrolled;function makeResizableDiv(e){const t=document.querySelector(e),s=document.querySelectorAll(e+" .resizer"),i=20;let o=0,a=0,n=0,l=0,r=0,d=0;for(let e=0;e<s.length;e++){const f=s[e];function p(e){if(f.classList.contains("bottom-right")){getParentCenter(),getCornerCoords(),getMaxRangeItem();const n=o+(e.pageX-r),l=a+(e.pageY-d);function s(){t.style.width=n+3+"px";var e=new Event("mouseup");window.dispatchEvent(e)}function p(){t.style.height=l+3+"px";var e=new Event("mouseup");window.dispatchEvent(e)}if(maxAboutWidth>n-40)return void s();if(maxAboutHeight>l-40)return void p();if(wrapperWidth-draggedMap.offsetWidth>sumPosAndTranslLeft){t.style.width=n+10+"px";var c=new Event("mouseup");return void window.dispatchEvent(c)}if(wrapperHeight-draggedMap.offsetHeight>sumPosAndTranslTop){t.style.height=l+10+"px";c=new Event("mouseup");return void window.dispatchEvent(c)}n>i&&(t.style.width=n+"px"),l>i&&(t.style.height=l+"px")}else if(f.classList.contains("bottom-left")){getParentCenter(),getCornerCoords(),getMaxRangeItem();const f=a+(e.pageY-d),g=o-(e.pageX-r);function s(){t.style.width=g+3+"px",t.style.left=n-3+(e.pageX-r)+"px";var s=new Event("mouseup");window.dispatchEvent(s)}function p(){t.style.height=f+3+"px";var e=new Event("mouseup");window.dispatchEvent(e)}if(maxAboutWidth>g-40)return void s();if(maxAboutHeight>f-40)return void p();if(sumPosAndTranslLeft>wrapperWidth){t.style.width=g+10+"px",t.style.left=n-10+(e.pageX-r)+"px";c=new Event("mouseup");return void window.dispatchEvent(c)}if(wrapperHeight-draggedMap.offsetHeight>sumPosAndTranslTop){t.style.height=f+10+"px",t.style.top=l+10+(e.pageY-d)+"px";c=new Event("mouseup");return void window.dispatchEvent(c)}f>i&&(t.style.height=f+"px"),g>i&&(t.style.width=g+"px",t.style.left=n+(e.pageX-r)+"px")}else if(f.classList.contains("top-right")){function s(){t.style.width=n+3+"px";var e=new Event("mouseup");window.dispatchEvent(e)}function p(){t.style.height=c+3+"px",t.style.top=l-3+(e.pageY-d)+"px";var s=new Event("mouseup");window.dispatchEvent(s)}getParentCenter(),getCornerCoords(),getMaxRangeItem();const n=o+(e.pageX-r),c=a-(e.pageY-d);if(maxAboutWidth>n-40)return void s();if(maxAboutHeight>c-40)return void p();if(wrapperWidth-draggedMap.offsetWidth>sumPosAndTranslLeft)return void s();if(wrapperHeight<sumPosAndTranslTop)return void p();n>i&&(t.style.width=n+"px"),c>i&&(t.style.height=c+"px",t.style.top=l+(e.pageY-d)+"px")}else{const f=o-(e.pageX-r),g=a-(e.pageY-d);function s(){t.style.width=f+3+"px",t.style.left=n-3+(e.pageX-r)+"px";var s=new Event("mouseup");window.dispatchEvent(s)}function p(){t.style.height=g+3+"px",t.style.top=l-3+(e.pageY-d)+"px";var s=new Event("mouseup");window.dispatchEvent(s)}if(getParentCenter(),getCornerCoords(),getMaxRangeItem(),maxAboutWidth>f-40)return void s();if(maxAboutHeight>g-40)return void p();if(sumPosAndTranslLeft>wrapperWidth){t.style.width=f+10+"px",t.style.left=n-10+(e.pageX-r)+"px";c=new Event("mouseup");return void window.dispatchEvent(c)}if(wrapperHeight<sumPosAndTranslTop){t.style.height=g+10+"px",t.style.top=l-10+(e.pageY-d)+"px";c=new Event("mouseup");return void window.dispatchEvent(c)}f>i&&(t.style.width=f+"px",t.style.left=n+(e.pageX-r)+"px"),g>i&&(t.style.height=g+"px",t.style.top=l+(e.pageY-d)+"px")}}function c(){window.removeEventListener("mousemove",p)}f.addEventListener("mousedown",(function(e){e.preventDefault(),o=parseFloat(getComputedStyle(t,null).getPropertyValue("width").replace("px","")),a=parseFloat(getComputedStyle(t,null).getPropertyValue("height").replace("px","")),n=t.offsetLeft,l=t.offsetTop,r=e.pageX,d=e.pageY,window.addEventListener("mousemove",p),window.addEventListener("mouseup",c)}))}}window.onscroll=function(){scrolled=window.pageYOffset||document.documentElement.scrollTop,document.getElementById("scroll").innerHTML=scrolled+"px : scroll"},$(window).on("load resize",(function(){var e=$("html").outerWidth(),t=$(window).height();$("#width").html(e+"px : width"),$("#height").html(t+"px : height")})),document.onmousemove=function(e){var t=e.pageX,s=e.pageY;document.getElementById("mouseX").innerHTML=t+": mouseX",document.getElementById("mouseY").innerHTML=s+": mouseY"},makeResizableDiv(".resizable");const btnTable=document.querySelector(".j-wrap-content-sidebar__add-table-btn"),wrapperDraggerMap=document.querySelector(".j-wrap-content-map"),draggedMap=document.querySelector(".draggedMap"),restricter=document.querySelector(".resizable__restricter"),resizers=document.querySelector(".resizers"),mapConner=document.querySelectorAll(".resizer");let sides=document.querySelectorAll(".resizerWindow");const addTableBtn=document.querySelector(".j-wrap-content-sidebar__add-table-btn");let boxItems=document.querySelectorAll(".box-item");const targetElement=document.querySelector(".draggable-item--uno");function disableDragMap(e){e.forEach(e=>{e.addEventListener("mouseover",(function(){Draggable.get(draggedMap).disable()}))}),mapConner.forEach(e=>{e.addEventListener("mouseout",dragMap)})}function onDragRestrictMap(){let e,t;switch(getParentCenter(),getCornerCoords(),!0){case wrapperWidth<sumPosAndTranslLeft:Draggable.get(draggedMap).endDrag(),e=Draggable.get(draggedMap).x,t=Draggable.get(draggedMap).y,TweenLite.set(this.target,{x:e-20,y:t});break;case wrapperHeight<sumPosAndTranslTop:Draggable.get(draggedMap).endDrag(),e=Draggable.get(draggedMap).x,t=Draggable.get(draggedMap).y,TweenLite.set(this.target,{x:e,y:t-20});break;case wrapperWidth-draggedMap.offsetWidth>sumPosAndTranslLeft:Draggable.get(draggedMap).endDrag(),e=Draggable.get(draggedMap).x,t=Draggable.get(draggedMap).y,TweenLite.set(this.target,{x:e+20,y:t});break;case wrapperHeight-draggedMap.offsetHeight>sumPosAndTranslTop:Draggable.get(draggedMap).endDrag(),e=Draggable.get(draggedMap).x,t=Draggable.get(draggedMap).y,TweenLite.set(this.target,{x:e,y:t+20});break;default:return}}var mapDraggble;function dragMap(){mapDraggble=Draggable.create(draggedMap,{onDrag:onDragRestrictMap})[0]}let wrapperWidth,wrapperHeight,itemCoords;function getParentCenter(){wrapperWidth=parseFloat(getComputedStyle(wrapperDraggerMap,null).getPropertyValue("width").replace("px",""))/2,wrapperHeight=parseFloat(getComputedStyle(wrapperDraggerMap,null).getPropertyValue("height").replace("px",""))/2}function getAllItemCoords(){itemCoords=[],boxItems.forEach((e,t)=>{let s={};s.id=e.id;const i=e.style.transform||"translate(0px, 0px)";return s.itemTranslateLeft=getTranslateXValue(i),s.itemTranslateTop=getTranslateYValue(i),s.itemWidth=e.offsetWidth,s.itemHeight=e.offsetHeight,s.positionLeft=e.offsetLeft,s.positionTop=e.offsetTop,itemCoords=[...itemCoords,s],[...itemCoords,s]})}disableDragMap(mapConner),dragMap(),getAllItemCoords();let sumPosAndTranslLeft,sumPosAndTranslTop,maxAboutWidth=0,maxAboutHeight=0;function getMaxRangeItem(){getAllItemCoords();const e=[],t=[];itemCoords.forEach(s=>{let i=s.itemTranslateLeft+s.positionLeft+s.itemWidth,o=s.itemTranslateTop+s.positionTop+s.itemHeight;e.push(i);let a=Math.max(...e);t.push(o);let n=Math.max(...t);maxAboutWidth=a,maxAboutHeight=n})}function getCornerCoords(){let e=draggedMap.offsetLeft,t=draggedMap.offsetTop;const s=draggedMap.style.transform||"translate(0px, 0px)";let i=getTranslateXValue(s),o=getTranslateYValue(s);sumPosAndTranslLeft=i+e,sumPosAndTranslTop=o+t}function getTranslateXValue(e){var t=e.indexOf("("),s=e.indexOf(",");return parseInt(e.slice(t+1,s-2))}function getTranslateYValue(e){var t=e.indexOf(","),s=e.indexOf(")");return parseInt(e.slice(t+1,s-1))}var draggableCollection;function draggable(){draggableCollection=Draggable.create(boxItems,{bounds:restricter,cursor:"pointer",type:"x, y",onPress:onPress,onRelease:onRelease,onDragStart:onStart,onDragEnd:function(){console.log(this),boxItems.forEach(e=>{e.style.color="blue",e.style.pointerEvents="auto"}),boxItems.forEach(e=>{this.hitTest(e)&&TweenMax.to(this.target,.1,{x:xx,y:yy})})}})}getMaxRangeItem(),getCornerCoords(),draggable();var chairs,xx=0,yy=0;function onPress(){xx=this.x,yy=this.y,(new TimelineMax).to(this.target,.1,{scale:1,opacity:1,ease:Power4.easeIn}),this.target.style.opacity<1&&(btnTable.addEventListener("click",onCreateTable),buttonForTextItem.addEventListener("click",onCreateItem))}function onStart(){mapDraggble.disable(),boxItems.forEach(e=>{e.style.pointerEvents="none"}),(new TimelineMax).to(this.target,.1,{opacity:1})}function onRelease(){getMaxRangeItem(),getAllItemCoords(),mapDraggble.enable()}function onCreateTable(){const e=document.createElement("div"),t=e.id="id"+Date.now();console.log(t),e.classList.add(t),e.classList.add("box-item"),e.classList.add("any-map-item"),e.classList.add("draggable-item"),e.classList.add("resizableTable");const s=document.createElement("div");s.classList.add("resizerTablesTable"),e.appendChild(s);const i=document.createElement("div");i.classList.add("resizerTable","top-left");const o=document.createElement("div");o.classList.add("resizerTable","top-right");const a=document.createElement("div");a.classList.add("resizerTable","bottom-left");const n=document.createElement("div");n.classList.add("resizerTable","bottom-right"),s.appendChild(i),s.appendChild(o),s.appendChild(a),s.appendChild(n);const l=document.createElement("div");l.classList.add("tableCenter"),e.appendChild(l);const r=document.createElement("div");r.classList.add("tableCenter-line"),l.appendChild(r);const d=document.createElement("div");d.innerHTML="x",d.classList.add("tableCenter-del"),l.appendChild(d);const p=document.createElement("div");p.classList.add("tableText");const c=document.createElement("p");c.innerHTML="text",c.classList.add("tebleTextP"),p.appendChild(c),l.appendChild(p);const f=document.createElement("input");f.classList.add("tableText__input"),f.type="text",f.name="tableText",f.value="",l.appendChild(f);const g=document.createElement("div");g.classList.add("chair","elipsTop");const u=document.createElement("div");u.classList.add("chair","elipsBottom");const m=document.createElement("div");m.classList.add("chair","elipsLeft");const h=document.createElement("div");let T;h.classList.add("chair","elipsRight"),l.appendChild(g),l.appendChild(u),l.appendChild(m),l.appendChild(h),d.addEventListener("click",(function(){T=e.parentNode.removeChild(e),console.log(T),itemCoords=itemCoords.filter(e=>e.id!=T.id),boxItems=document.querySelectorAll(".box-item"),console.log(itemCoords)})),resizers.appendChild(e),corners=document.querySelectorAll(".resizerTable"),boxItems=document.querySelectorAll(".box-item"),getAllItemCoords(),onChangeColor("."+t),disableDraggableParent(),tables=document.querySelectorAll(".resizerTablesTable"),replaceLine("."+t),draggable(),makeresizableTableDiv("."+t),inputsHandler("."+t),onConflictItemsWithOther(),onShowTableAnimation("."+t),buttonForTextItem.removeEventListener("click",onCreateItem),btnTable.removeEventListener("click",onCreateTable)}function makeresizableTableDiv(e){const t=document.querySelector(e),s=document.querySelectorAll(e+" .resizerTable"),i=20;let o=0,a=0,n=0,l=0,r=0,d=0;for(let f=0;f<s.length;f++){const g=s[f];function p(s){if(g.classList.contains("bottom-right")){addTopAndBottomChair(e),addLeftAndRightChair(e),replaceLine(e),onChangeColor(),onConflictItemWithMap(e),onConflictItemsWithOther(e);const n=o+(s.pageX-r),l=a+(s.pageY-d);n>i&&(t.style.width=n+"px"),l>i&&(t.style.height=l+"px")}else if(g.classList.contains("bottom-left")){addTopAndBottomChair(e),addLeftAndRightChair(e),replaceLine(e),onChangeColor(),onConflictItemWithMap(e),onConflictItemsWithOther(e);const l=a+(s.pageY-d),p=o-(s.pageX-r);l>i&&(t.style.height=l+"px"),p>i&&(t.style.width=p+"px",t.style.left=n+(s.pageX-r)+"px")}else if(g.classList.contains("top-right")){addTopAndBottomChair(e),addLeftAndRightChair(e),replaceLine(e),onChangeColor(),onConflictItemWithMap(e),onConflictItemsWithOther(e);const n=o+(s.pageX-r),p=a-(s.pageY-d);n>i&&(t.style.width=n+"px"),p>i&&(t.style.height=p+"px",t.style.top=l+(s.pageY-d)+"px")}else{addTopAndBottomChair(e),addLeftAndRightChair(e),replaceLine(e),onChangeColor(),onConflictItemWithMap(e),onConflictItemsWithOther(e);const p=o-(s.pageX-r),c=a-(s.pageY-d);p>i&&(t.style.width=p+"px",t.style.left=n+(s.pageX-r)+"px"),c>i&&(t.style.height=c+"px",t.style.top=l+(s.pageY-d)+"px")}}function c(){window.removeEventListener("mousemove",p)}g.addEventListener("mousedown",(function(e){e.preventDefault(),o=parseFloat(getComputedStyle(t,null).getPropertyValue("width").replace("px","")),a=parseFloat(getComputedStyle(t,null).getPropertyValue("height").replace("px","")),n=t.offsetLeft,l=t.offsetTop,r=e.pageX,d=e.pageY,window.addEventListener("mousemove",p),window.addEventListener("mouseup",c)}))}}function replaceLine(e){const t=document.querySelector(e),s=document.querySelector(`${e} .tableCenter-line`);if(s)switch(!0){case t.offsetWidth<=t.offsetHeight:s.style.width="100%",s.style.height="14px",s.style.borderRadius="15px 15px 0 0";break;case t.offsetWidth>t.offsetHeight:s.style.width="14px",s.style.height="100%",s.style.borderRadius="15px 0 0 15px";default:return}}function addTopAndBottomChair(e){const t=document.querySelector(e+" .tableCenter");if(t.firstChild.classList.contains("tableCenter-line")){function s(t){!function(t){const s=document.querySelector(e+" "+t);s&&(removed=s.parentNode.removeChild(s))}(t)}switch(!0){case t.offsetWidth>415&&t.offsetWidth<=455:s(".elipsTop11");break;case t.offsetWidth>375&&t.offsetWidth<=415:s(".elipsTop10"),s(".elipsTop11");break;case t.offsetWidth>335&&t.offsetWidth<=375:s(".elipsTop9"),s(".elipsTop10"),s(".elipsTop11");break;case t.offsetWidth>295&&t.offsetWidth<=335:s(".elipsTop8"),s(".elipsTop9"),s(".elipsTop10"),s(".elipsTop11");break;case t.offsetWidth>255&&t.offsetWidth<=295:s(".elipsTop7"),s(".elipsTop8"),s(".elipsTop9"),s(".elipsTop10"),s(".elipsTop11");break;case t.offsetWidth>215&&t.offsetWidth<=255:s(".elipsTop6"),s(".elipsTop7"),s(".elipsTop8"),s(".elipsTop9"),s(".elipsTop10"),s(".elipsTop11");break;case t.offsetWidth>175&&t.offsetWidth<=215:s(".elipsTop5"),s(".elipsTop6"),s(".elipsTop7"),s(".elipsTop8"),s(".elipsTop9"),s(".elipsTop10"),s(".elipsTop11");break;case t.offsetWidth>135&&t.offsetWidth<=175:s(".elipsTop4"),s(".elipsTop5"),s(".elipsTop6"),s(".elipsTop7"),s(".elipsTop8"),s(".elipsTop9"),s(".elipsTop10"),s(".elipsTop11");break;case t.offsetWidth>95&&t.offsetWidth<=135:s(".elipsTop3"),s(".elipsTop4"),s(".elipsTop5"),s(".elipsTop6"),s(".elipsTop7"),s(".elipsTop8"),s(".elipsTop9"),s(".elipsTop10"),s(".elipsTop11");break;case t.offsetWidth<=95:document.querySelector(".elipsTop2")&&(s(".elipsTop2"),s(".elipsTop3"),s(".elipsTop4"),s(".elipsTop5"),s(".elipsTop6"),s(".elipsTop7"),s(".elipsTop8"),s(".elipsTop9"),s(".elipsTop10"),s(".elipsTop11"))}function i(s){if(!document.querySelector(e+" "+s)){let e=document.createElement("div");e.classList.add("elipsTop"),e.classList.add("chair"),e.classList.add(s.slice(1)),t.appendChild(e);let i=document.createElement("div");i.classList.add("elipsBottom"),i.classList.add("chair"),i.classList.add(s.slice(1)),t.appendChild(i)}}switch(!0){case t.offsetWidth>415:i(".elipsTop10"),i(".elipsTop9"),i(".elipsTop8"),i(".elipsTop7"),i(".elipsTop6"),i(".elipsTop5"),i(".elipsTop4"),i(".elipsTop3"),i(".elipsTop2");break;case t.offsetWidth>375&&t.offsetWidth<=415:i(".elipsTop9"),i(".elipsTop8"),i(".elipsTop7"),i(".elipsTop6"),i(".elipsTop5"),i(".elipsTop4"),i(".elipsTop3"),i(".elipsTop2");break;case t.offsetWidth>335&&t.offsetWidth<=375:i(".elipsTop8"),i(".elipsTop7"),i(".elipsTop6"),i(".elipsTop5"),i(".elipsTop4"),i(".elipsTop3"),i(".elipsTop2");break;case t.offsetWidth>295&&t.offsetWidth<=335:i(".elipsTop7"),i(".elipsTop6"),i(".elipsTop5"),i(".elipsTop4"),i(".elipsTop3"),i(".elipsTop2");break;case t.offsetWidth>255&&t.offsetWidth<=295:i(".elipsTop6"),i(".elipsTop5"),i(".elipsTop4"),i(".elipsTop3"),i(".elipsTop2");break;case t.offsetWidth>215&&t.offsetWidth<=255:i(".elipsTop5"),i(".elipsTop4"),i(".elipsTop3"),i(".elipsTop2");break;case t.offsetWidth>175&&t.offsetWidth<=215:i(".elipsTop4"),i(".elipsTop3"),i(".elipsTop2");break;case t.offsetWidth>135&&t.offsetWidth<=175:i(".elipsTop3"),i(".elipsTop2");break;case t.offsetWidth>95&&t.offsetWidth<=135:i(".elipsTop2")}}}function addLeftAndRightChair(e){const t=document.querySelector(e+" .tableCenter");if(t.firstChild.classList.contains("tableCenter-line")){function s(t){!function(t){const s=document.querySelector(e+" "+t);s&&(removed=s.parentNode.removeChild(s))}(t)}switch(!0){case t.offsetHeight>415&&t.offsetHeight<=455:s(".elipsLeft11");break;case t.offsetHeight>375&&t.offsetHeight<=415:s(".elipsLeft10"),s(".elipsLeft11");break;case t.offsetHeight>335&&t.offsetHeight<=375:s(".elipsLeft9"),s(".elipsLeft10"),s(".elipsLeft11");break;case t.offsetHeight>295&&t.offsetHeight<=335:s(".elipsLeft8"),s(".elipsLeft9"),s(".elipsLeft10"),s(".elipsLeft11");break;case t.offsetHeight>255&&t.offsetHeight<=295:s(".elipsLeft7"),s(".elipsLeft8"),s(".elipsLeft9"),s(".elipsLeft10"),s(".elipsLeft11");break;case t.offsetHeight>215&&t.offsetHeight<=255:s(".elipsLeft6"),s(".elipsLeft7"),s(".elipsLeft8"),s(".elipsLeft9"),s(".elipsLeft10"),s(".elipsLeft11");break;case t.offsetHeight>175&&t.offsetHeight<=215:s(".elipsLeft5"),s(".elipsLeft6"),s(".elipsLeft7"),s(".elipsLeft8"),s(".elipsLeft9"),s(".elipsLeft10"),s(".elipsLeft11");break;case t.offsetHeight>135&&t.offsetHeight<=175:s(".elipsLeft4"),s(".elipsLeft5"),s(".elipsLeft6"),s(".elipsLeft7"),s(".elipsLeft8"),s(".elipsLeft9"),s(".elipsLeft10"),s(".elipsLeft11");break;case t.offsetHeight>95&&t.offsetHeight<=135:s(".elipsLeft3"),s(".elipsLeft4"),s(".elipsLeft5"),s(".elipsLeft6"),s(".elipsLeft7"),s(".elipsLeft8"),s(".elipsLeft9"),s(".elipsLeft10"),s(".elipsLeft11");break;case t.offsetHeight<=95:document.querySelector(".elipsLeft2")&&(s(".elipsLeft2"),s(".elipsLeft3"),s(".elipsLeft4"),s(".elipsLeft5"),s(".elipsLeft6"),s(".elipsLeft7"),s(".elipsLeft8"),s(".elipsLeft9"),s(".elipsLeft10"),s(".elipsLeft11"))}function i(s){if(!document.querySelector(e+" "+s)){let e=document.createElement("div");e.classList.add("elipsLeft"),e.classList.add("chair"),e.classList.add(s.slice(1)),t.appendChild(e);let i=document.createElement("div");i.classList.add("elipsRight"),i.classList.add("chair"),i.classList.add(s.slice(1)),t.appendChild(i)}}switch(!0){case t.offsetHeight>415:i(".elipsLeft10"),i(".elipsLeft9"),i(".elipsLeft8"),i(".elipsLeft7"),i(".elipsLeft6"),i(".elipsLeft5"),i(".elipsLeft4"),i(".elipsLeft3"),i(".elipsLeft2");break;case t.offsetHeight>375&&t.offsetHeight<=415:i(".elipsLeft9"),i(".elipsLeft8"),i(".elipsLeft7"),i(".elipsLeft6"),i(".elipsLeft5"),i(".elipsLeft4"),i(".elipsLeft3"),i(".elipsLeft2");break;case t.offsetHeight>335&&t.offsetHeight<=375:i(".elipsLeft8"),i(".elipsLeft7"),i(".elipsLeft6"),i(".elipsLeft5"),i(".elipsLeft4"),i(".elipsLeft3"),i(".elipsLeft2");break;case t.offsetHeight>295&&t.offsetHeight<=335:i(".elipsLeft7"),i(".elipsLeft6"),i(".elipsLeft5"),i(".elipsLeft4"),i(".elipsLeft3"),i(".elipsLeft2");break;case t.offsetHeight>255&&t.offsetHeight<=295:i(".elipsLeft6"),i(".elipsLeft5"),i(".elipsLeft4"),i(".elipsLeft3"),i(".elipsLeft2");break;case t.offsetHeight>215&&t.offsetHeight<=255:i(".elipsLeft5"),i(".elipsLeft4"),i(".elipsLeft3"),i(".elipsLeft2");break;case t.offsetHeight>175&&t.offsetHeight<=215:i(".elipsLeft4"),i(".elipsLeft3"),i(".elipsLeft2");break;case t.offsetHeight>135&&t.offsetHeight<=175:i(".elipsLeft3"),i(".elipsLeft2");break;case t.offsetHeight>95:i(".elipsLeft2")}}}function onChangeColor(){(chairs=document.querySelectorAll(".chair")).forEach(e=>{e.addEventListener("click",changeColorChair)})}function changeColorChair(e){e.target.classList.toggle("elipsBgColored")}function disableDraggableParent(){document.querySelectorAll(".resizerTablesTable").forEach(e=>{e.addEventListener("mouseover",(function(){document.querySelectorAll(".resizerTable").forEach(e=>{this.style.opacity="1"}),dragDisable(mapDraggble,draggableCollection)})),e.addEventListener("mouseout",(function(){document.querySelectorAll(".resizerTable").forEach(e=>{this.style.opacity="0"}),dragEnable(mapDraggble,draggableCollection)}))})}function dragDisable(e,t){e.disable(),t.forEach(e=>{e.disable()})}function dragEnable(e,t){e.enable(),t.forEach(e=>{e.enable()})}function inputsHandler(e){let t=document.querySelector(e+" .tebleTextP");const s=document.querySelector(e+" .tableText__input");t.addEventListener("dblclick",(function(){function e(){t.innerHTML=this.value||"num",s.style.display="none",t.style.display="block"}this.style.display="none",s.style.display="block",s.focus(),s.value=t.innerHTML,s.addEventListener("blur",e),s.addEventListener("keypress",(function(t){13===t.keyCode&&e()}))}))}function onConflictItemWithMap(e){const t=document.querySelector(e);if(t){const e=t.offsetWidth,l=t.offsetHeight;let r,d,p,c;const f=draggedMap.offsetWidth,g=draggedMap.offsetHeight;function s(){let e=t.offsetLeft,s=t.offsetTop;const i=t.style.transform||"translate(0px, 0px)";let o=getTranslateXValue(i),a=getTranslateYValue(i);r=o+e,d=a+s}function i(){if(e+r>f-40){var s=new Event("mouseup");window.dispatchEvent(s),p=r,t.style.maxWidth=e-7+"px"}p!==r&&(t.style.maxWidth="")}function o(){if(l+d>g-40){var e=new Event("mouseup");window.dispatchEvent(e),c=d,t.style.maxHeight=l-7+"px"}c!==d&&(t.style.maxHeight="")}function a(){if(r<45){var e=new Event("mouseup");window.dispatchEvent(e),t.style.maxWidth=f-10+"px",p=t.style.width,t.style.left="40px"}}function n(){if(d<45){var e=new Event("mouseup");window.dispatchEvent(e)}}s(),i(),o(),a(),n()}}function onConflictItemsWithOther(e){const t=document.querySelector(e);if(t){const e=itemCoords.filter(e=>e.id!==t.id),a=t.offsetWidth,n=t.offsetHeight,l=t.offsetLeft,r=t.offsetTop,d=t.style.transform||"translate(0px, 0px)",p=getTranslateXValue(d),c=getTranslateYValue(d);function s(){const t=e.filter(e=>e.itemTranslateTop+e.positionTop+e.itemHeight>r+c&&e.itemTranslateTop+e.positionTop<r+c+n&&e.itemTranslateLeft+e.positionLeft>l+p).map(e=>e.positionLeft+e.itemTranslateLeft);let s;switch(s=Math.min(...t),!0){case void 0!==s&&a+l+p>s&&l+p<s:s=Math.min(...t);let e=new Event("mouseup");window.dispatchEvent(e),console.log("bum bum");break;default:return!1}}function i(){const t=e.filter(e=>e.itemTranslateLeft+e.positionLeft+e.itemWidth>l+p&&e.itemTranslateLeft+e.positionLeft<l+p+a),s=t.map(e=>e.positionTop+e.itemTranslateTop),i=t.find(e=>e.positionTop+e.itemTranslateTop==s);let o;i&&(o=i.itemHeight||0);const d=Math.min(...s);if(n+r+c>d&&r+c<d+o){var f=new Event("mouseup");window.dispatchEvent(f),console.log("slam"),console.log(d)}}function o(){const t=e.filter(e=>e.itemTranslateTop+e.positionTop+e.itemHeight>r+c&&e.itemTranslateTop+e.positionTop<r+c+n&&e.itemTranslateLeft+e.positionLeft<l+p),s=t.map(e=>e.positionLeft+e.itemTranslateLeft);let i,o,a=Math.max(...s);switch(t&&(i=t.find(e=>e.positionLeft+e.itemTranslateLeft==a)),i&&(o=i.positionLeft+i.itemTranslateLeft+i.itemWidth||0),!0){case void 0!==i&&l+p<o:let e=new Event("mouseup");window.dispatchEvent(e),console.log("bumssss");break;default:return!1}}s(),i(),o()}}btnTable.addEventListener("click",onCreateTable),makeresizableTableDiv(".resizableTable"),disableDraggableParent(),onConflictItemsWithOther();const buttonForTextItem=document.getElementById("addElement");function onCreateItem(){const e=document.createElement("div"),t=e.id="id"+Date.now();console.log(t),e.classList.add(t),e.classList.add("box-item"),e.classList.add("any-map-item"),e.classList.add("draggable-item"),e.classList.add("resizableTable");const s=document.createElement("div");s.classList.add("resizerTablesTable"),e.appendChild(s);const i=document.createElement("div");i.classList.add("resizerTable","top-left");const o=document.createElement("div");o.classList.add("resizerTable","top-right");const a=document.createElement("div");a.classList.add("resizerTable","bottom-left");const n=document.createElement("div");n.classList.add("resizerTable","bottom-right"),s.appendChild(i),s.appendChild(o),s.appendChild(a),s.appendChild(n);const l=document.createElement("div");l.classList.add("tableCenter"),l.classList.add("text-item"),e.appendChild(l);const r=document.createElement("div");r.innerHTML="x",r.classList.add("tableCenter-del"),l.appendChild(r);const d=document.createElement("div");d.classList.add("tableText");const p=document.createElement("p");p.innerHTML="text",p.classList.add("tebleTextP"),d.appendChild(p),l.appendChild(d);const c=document.createElement("input");let f;c.classList.add("tableText__input"),c.type="text",c.name="tableText",c.value="",l.appendChild(c),r.addEventListener("click",(function(){f=e.parentNode.removeChild(e),console.log(f),itemCoords=itemCoords.filter(e=>e.id!=f.id),boxItems=document.querySelectorAll(".box-item"),console.log(itemCoords)})),resizers.appendChild(e),corners=document.querySelectorAll(".resizerTable"),boxItems=document.querySelectorAll(".box-item"),getAllItemCoords(),disableDraggableParent(),tables=document.querySelectorAll(".resizerTablesTable"),draggable(),makeresizableTableDiv("."+t),inputsHandler("."+t),onConflictItemsWithOther(),onShowTableAnimation("."+t),buttonForTextItem.removeEventListener("click",onCreateItem),btnTable.removeEventListener("click",onCreateTable)}buttonForTextItem.addEventListener("click",onCreateItem);let windowsDrag=document.querySelectorAll(".windowsDrag");const windowTopRestrictor=document.querySelector(".resizable-wall.resizable-wall--top");let windowDraggble,startX,startY;function dragWindow(e,t,s){windowDraggble=Draggable.create(e,{type:s,onDragStart:function(){mapDraggble.disable(),startX=this.x,startY=this.y},onRelease:function(){mapDraggble.enable()},onDragEnd:function(){e.forEach(e=>{this.hitTest(e)&&TweenMax.to(this.target,.1,{x:startX,y:startY})})},bounds:t})}dragWindow(windowsDrag,windowTopRestrictor,"x");const windowButton=document.querySelector("#addWindow");function createWindow(){const e=document.querySelector(".resizable-wall"),t=document.createElement("div");t.style.display="block";const s=t.id="id"+Date.now();console.log(s),t.classList.add(s),t.classList.add("resizableWindowWrapper"),t.classList.add("windowsDrag");const i=document.createElement("div");i.classList.add("resizerWindowInner"),t.appendChild(i);const o=document.createElement("div");o.classList.add("resizerWindow","left-side");const a=document.createElement("div");a.classList.add("resizerWindow","top-side");const n=document.createElement("div");n.classList.add("resizerWindow","bottom-side");const l=document.createElement("div");l.classList.add("resizerWindow","right-side"),i.appendChild(o),i.appendChild(a),i.appendChild(n),i.appendChild(l),e.appendChild(t);const r=document.createElement("div");r.classList.add("tableText","window-text"),r.style.display="block";const d=document.createElement("p");d.innerHTML="text",d.classList.add("tebleTextP"),r.appendChild(d),t.appendChild(r);const p=document.createElement("input");p.classList.add("tableText__input","window-input"),p.type="text",p.name="tableText",p.value="",t.appendChild(p);const c=document.createElement("div");let f;c.innerHTML="x",c.classList.add("tableCenter-del"),i.appendChild(c),c.addEventListener("click",(function(){f=t.parentNode.removeChild(t),console.log(f),itemCoords=itemCoords.filter(e=>e.id!=f.id),boxItems=document.querySelectorAll(".box-item"),console.log(itemCoords)})),sides=document.querySelectorAll(".resizerWindow"),windowsDrag=document.querySelectorAll(".windowsDrag"),disableWindowParent(sides),makeresizableWindowDiv("."+s),dragWindow(windowsDrag,windowTopRestrictor,"x"),inputsHandler("."+s)}function onShowTableAnimation(e){console.log(draggedMap.offsetWidth/2);const t={x:draggedMap.offsetWidth/2-50,y:draggedMap.offsetHeight/2-50,opacity:.6,scale:.96,zIndex:1005};TweenMax.fromTo(e,.2,{x:0,y:0,opacity:.2,scale:.4,delay:.2},t)}function makeresizableWindowDiv(e){const t=document.querySelector(e),s=document.querySelectorAll(e+" .resizerWindow"),i=60;let o=0,a=0,n=0,l=0,r=0,d=0;for(let e=0;e<s.length;e++){const f=s[e];function p(e){if(f.classList.contains("right-side")){const s=o+(e.pageX-r);s>i&&(t.style.width=s+"px")}else if(f.classList.contains("bottom-side")){const s=a+(e.pageY-d);s>i&&(t.style.height=s+"px")}else if(f.classList.contains("top-side")){const s=a-(e.pageY-d);s>i&&(t.style.height=s+"px",t.style.top=l+(e.pageY-d)+"px")}else{const s=o-(e.pageX-r);s>i&&(t.style.width=s+"px",t.style.left=n+(e.pageX-r)+"px")}}function c(){window.removeEventListener("mousemove",p)}f.addEventListener("mousedown",(function(e){e.preventDefault(),o=parseFloat(getComputedStyle(t,null).getPropertyValue("width").replace("px","")),a=parseFloat(getComputedStyle(t,null).getPropertyValue("height").replace("px","")),n=t.offsetLeft,l=t.offsetTop,r=e.pageX,d=e.pageY,window.addEventListener("mousemove",p),window.addEventListener("mouseup",c)}))}}windowButton.addEventListener("click",createWindow),makeresizableWindowDiv(".resizableWindowWrapper");const collectionWindowItems=document.querySelectorAll(".resizerWindowInner");function disableWindowParent(e){function t(){dragDisable(mapDraggble,windowDraggble)}function s(){dragEnable(mapDraggble,windowDraggble)}e.forEach(e=>{e.addEventListener("mouseover",t),e.addEventListener("mouseout",s)})}disableWindowParent(sides);