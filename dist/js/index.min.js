var scrolled;function makeResizableDiv(e){const t=document.querySelector(e),a=document.querySelectorAll(e+" .resizer"),o=20;let r=0,n=0,s=0,i=0,d=0,g=0;for(let e=0;e<a.length;e++){const u=a[e];function l(e){if(u.classList.contains("bottom-right")){getParentCenter(),getCornerCoords(),getItemCoords(),getMaxRangeItem();const s=r+(e.pageX-d),i=n+(e.pageY-g);function a(){t.style.width=s+3+"px";var e=new Event("mouseup");window.dispatchEvent(e)}function l(){t.style.height=i+3+"px";var e=new Event("mouseup");window.dispatchEvent(e)}if(maxAboutWidth>s-10)return void a();if(maxAboutHeight>i-10)return void l();if(wrapperWidth-draggedMap.offsetWidth>sumPosAndTranslLeft){t.style.width=s+10+"px";var p=new Event("mouseup");return void window.dispatchEvent(p)}if(wrapperHeight-draggedMap.offsetHeight>sumPosAndTranslTop){t.style.height=i+10+"px";p=new Event("mouseup");return void window.dispatchEvent(p)}s>o&&(t.style.width=s+"px"),i>o&&(t.style.height=i+"px")}else if(u.classList.contains("bottom-left")){getParentCenter(),getCornerCoords(),getItemCoords(),getMaxRangeItem();const u=n+(e.pageY-g),m=r-(e.pageX-d);function a(){t.style.width=m+3+"px",t.style.left=s-3+(e.pageX-d)+"px";var a=new Event("mouseup");window.dispatchEvent(a)}function l(){t.style.height=u+3+"px";var e=new Event("mouseup");window.dispatchEvent(e)}if(maxAboutWidth>m-10)return void a();if(maxAboutHeight>u-10)return void l();if(sumPosAndTranslLeft>wrapperWidth){t.style.width=m+10+"px",t.style.left=s-10+(e.pageX-d)+"px";p=new Event("mouseup");return void window.dispatchEvent(p)}if(wrapperHeight-draggedMap.offsetHeight>sumPosAndTranslTop){t.style.height=u+10+"px",t.style.top=i+10+(e.pageY-g)+"px";p=new Event("mouseup");return void window.dispatchEvent(p)}u>o&&(t.style.height=u+"px"),m>o&&(t.style.width=m+"px",t.style.left=s+(e.pageX-d)+"px")}else if(u.classList.contains("top-right")){function a(){t.style.width=s+3+"px";var e=new Event("mouseup");window.dispatchEvent(e)}function l(){t.style.height=p+3+"px",t.style.top=i-3+(e.pageY-g)+"px";var a=new Event("mouseup");window.dispatchEvent(a)}getParentCenter(),getCornerCoords(),getItemCoords(),getMaxRangeItem();const s=r+(e.pageX-d),p=n-(e.pageY-g);if(maxAboutWidth>s-10)return void a();if(maxAboutHeight>p-10)return void l();if(wrapperWidth-draggedMap.offsetWidth>sumPosAndTranslLeft)return void a();if(wrapperHeight<sumPosAndTranslTop)return void l();s>o&&(t.style.width=s+"px"),p>o&&(t.style.height=p+"px",t.style.top=i+(e.pageY-g)+"px")}else{const u=r-(e.pageX-d),m=n-(e.pageY-g);function a(){t.style.width=u+3+"px",t.style.left=s-3+(e.pageX-d)+"px";var a=new Event("mouseup");window.dispatchEvent(a)}function l(){t.style.height=m+3+"px",t.style.top=i-3+(e.pageY-g)+"px";var a=new Event("mouseup");window.dispatchEvent(a)}if(getParentCenter(),getCornerCoords(),getItemCoords(),getMaxRangeItem(),maxAboutWidth>u-10)return void a();if(maxAboutHeight>m-10)return void l();if(sumPosAndTranslLeft>wrapperWidth){t.style.width=u+10+"px",t.style.left=s-10+(e.pageX-d)+"px";p=new Event("mouseup");return void window.dispatchEvent(p)}if(wrapperHeight<sumPosAndTranslTop){t.style.height=m+10+"px",t.style.top=i-10+(e.pageY-g)+"px";p=new Event("mouseup");return void window.dispatchEvent(p)}u>o&&(t.style.width=u+"px",t.style.left=s+(e.pageX-d)+"px"),m>o&&(t.style.height=m+"px",t.style.top=i+(e.pageY-g)+"px")}}function p(){window.removeEventListener("mousemove",l)}u.addEventListener("mousedown",(function(e){e.preventDefault(),r=parseFloat(getComputedStyle(t,null).getPropertyValue("width").replace("px","")),n=parseFloat(getComputedStyle(t,null).getPropertyValue("height").replace("px","")),s=t.offsetLeft,i=t.offsetTop,d=e.pageX,g=e.pageY,window.addEventListener("mousemove",l),window.addEventListener("mouseup",p)}))}}window.onscroll=function(){scrolled=window.pageYOffset||document.documentElement.scrollTop,document.getElementById("scroll").innerHTML=scrolled+"px : scroll"},$(window).on("load resize",(function(){var e=$("html").outerWidth(),t=$(window).height();$("#width").html(e+"px : width"),$("#height").html(t+"px : height")})),document.onmousemove=function(e){var t=e.pageX,a=e.pageY;document.getElementById("mouseX").innerHTML=t+": mouseX",document.getElementById("mouseY").innerHTML=a+": mouseY"},makeResizableDiv(".resizable");const btnTable=document.querySelector(".j-wrap-content-sidebar__add-table-btn"),wrapperDraggerMap=document.querySelector(".j-wrap-content-map"),draggedMap=document.querySelector(".draggedMap"),topLeftCorner=document.querySelector(".top-left"),mapConner=document.querySelectorAll(".resizer"),addTableBtn=document.querySelector(".j-wrap-content-sidebar__add-table-btn");let boxItems=document.querySelectorAll(".box-item");const targetElement=document.querySelector(".draggable-item--uno");function onDragRestrictMap(){let e,t;switch(getParentCenter(),getCornerCoords(),!0){case wrapperWidth<sumPosAndTranslLeft:Draggable.get(draggedMap).endDrag(),e=Draggable.get(draggedMap).x,t=Draggable.get(draggedMap).y,TweenLite.set(this.target,{x:e-20,y:t});break;case wrapperHeight<sumPosAndTranslTop:Draggable.get(draggedMap).endDrag(),e=Draggable.get(draggedMap).x,t=Draggable.get(draggedMap).y,TweenLite.set(this.target,{x:e,y:t-20});break;case wrapperWidth-draggedMap.offsetWidth>sumPosAndTranslLeft:Draggable.get(draggedMap).endDrag(),e=Draggable.get(draggedMap).x,t=Draggable.get(draggedMap).y,TweenLite.set(this.target,{x:e+20,y:t});break;case wrapperHeight-draggedMap.offsetHeight>sumPosAndTranslTop:Draggable.get(draggedMap).endDrag(),e=Draggable.get(draggedMap).x,t=Draggable.get(draggedMap).y,TweenLite.set(this.target,{x:e,y:t+20});break;default:return}}var mapDraggble;function dragMap(){mapDraggble=Draggable.create(draggedMap,{onDrag:onDragRestrictMap})[0]}let wrapperWidth,wrapperHeight,itemTranslateLeft,itemTranslateTop,itemWidth,itemHeight,maxItemWidth,maxItemHeight,itemCoords;function getParentCenter(){wrapperWidth=parseFloat(getComputedStyle(wrapperDraggerMap,null).getPropertyValue("width").replace("px",""))/2,wrapperHeight=parseFloat(getComputedStyle(wrapperDraggerMap,null).getPropertyValue("height").replace("px",""))/2}function getItemCoords(){itemWidth=targetElement.offsetWidth,itemHeight=targetElement.offsetHeight;const e=targetElement.style.transform||"translate(0px, 0px)";itemTranslateLeft=getTranslateXValue(e),itemTranslateTop=getTranslateYValue(e)}function getAllItemCoords(){itemCoords=[],boxItems.forEach((e,t)=>{let a={};a.id=e.id;const o=e.style.transform||"translate(0px, 0px)";a.itemTranslateLeft=getTranslateXValue(o),a.itemTranslateTop=getTranslateYValue(o),a.itemWidth=e.offsetWidth,a.itemHeight=e.offsetHeight,a.positionLeft=e.offsetLeft,a.positionTop=e.offsetTop,itemCoords=[...itemCoords,a]})}mapConner.forEach(e=>{e.addEventListener("mouseover",(function(){Draggable.get(draggedMap).disable()}))}),mapConner.forEach(e=>{e.addEventListener("mouseout",dragMap)}),dragMap(),getAllItemCoords();let sumPosAndTranslLeft,sumPosAndTranslTop,posLeft,posTop,maxAboutWidth=0,maxAboutHeight=0;function getMaxRangeItem(){getAllItemCoords();const e=[],t=[];itemCoords.forEach(a=>{let o=a.itemTranslateLeft+a.positionLeft+a.itemWidth,r=a.itemTranslateTop+a.positionTop+a.itemHeight;e.push(o);let n=Math.max(...e);t.push(r);let s=Math.max(...t);console.log(e),console.log(n),maxAboutWidth=n,maxAboutHeight=s})}function getTranslateXValue(e){var t=e.indexOf("("),a=e.indexOf(",");return parseInt(e.slice(t+1,a-2))}function getTranslateYValue(e){var t=e.indexOf(","),a=e.indexOf(")");return parseInt(e.slice(t+1,a-1))}function getCornerCoords(){posLeft=draggedMap.offsetLeft,posTop=draggedMap.offsetTop;const e=draggedMap.style.transform||"translate(0px, 0px)";let t=getTranslateXValue(e),a=getTranslateYValue(e);sumPosAndTranslLeft=t+posLeft,sumPosAndTranslTop=a+posTop}var draggableCollection;function draggable(){draggableCollection=Draggable.create(boxItems,{bounds:draggedMap,cursor:"pointer",type:"x, y",inertia:!0,onPress:onPress,onRelease:onRelease,onDragStart:onStart,onDragEnd:function(){boxItems.forEach(e=>{e.style.color="blue",e.style.pointerEvents="auto"}),boxItems.forEach(e=>{this.hitTest(e)&&TweenMax.to(this.target,1,{x:xx,y:yy})})}})}getMaxRangeItem(),getParentCenter(),getCornerCoords(),draggable(),draggable();var xx=0,yy=0;function onPress(){xx=this.x,yy=this.y,(new TimelineMax).to(this.target,.1,{borderColor:"white",borderWidth:6,ease:Power4.easeIn})}function onStart(){mapDraggble.disable(),boxItems.forEach(e=>{e.style.color="red",e.style.pointerEvents="none"}),(new TimelineMax).to(this.target,.1,{opacity:1,borderColor:"#828282",borderWidth:2,ease:Power4.easeIn})}function onRelease(){getMaxRangeItem(),mapDraggble.enable(),(new TimelineMax).to(this.target,.1,{borderWidth:3,ease:Power4.easeIn}),getAllItemCoords()}btnTable.addEventListener("click",(function(){let e=document.createElement("div");e.classList.add("box-item"),e.classList.add("draggable-item"),e.id=Date.now();let t,a=document.createElement("span");a.innerHTML="X",a.classList.add("spanClose"),a.addEventListener("click",(function(){t=e.parentNode.removeChild(e),console.log(t),itemCoords=itemCoords.filter(e=>e.id!=t.id),boxItems=document.querySelectorAll(".box-item"),console.log(itemCoords)})),draggedMap.appendChild(e),e.appendChild(a),boxItems=document.querySelectorAll(".box-item"),draggable(),getAllItemCoords()}));